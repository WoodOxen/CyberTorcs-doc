# PID控制器

## 基本原理

PID控制器（比例-积分-微分控制器），由比例单元（Proportional）、积分单元（Integral）和微分单元（Derivative）组成。可以透过调整这三个单元的增益来调定其特性。PID控制器**主要适用于基本上线性，且动态特性不随时间变化的系统**。

PID控制器中，比例单元基于当前反馈信号与期望值的误差计算；积分单元基于历史累积的误差计算，可以加速系统趋近设定值的过程，并且消除纯比例控制器会出现的稳态误差；微分单元基于误差的变化率计算，提升整定时间及系统稳定性。PID控制的具体实现方法是：根据反馈信号和期望值之间的差异，分别计算出比例、积分和微分三个量，然后对这三个量进行加权求和。若将$u(t)$记作控制输出，PID可以写成以下表达式：

$$
u(t) = K_p e(t) + K_i \int_0^t e(\tau)d\tau + K_d \frac{d}{dt}e(t)
$$

其中各变量含义为：

- $K_p$: 比例增益系数；
- $K_i$: 积分增益系数；
- $K_d$: 微分增益系数；
- $e$: 误差=设定值-真实值；
- $t$: 当前时间；
- $\tau$: 积分变数，数值从0到当前时间$t$。

PID控制器可以视为是频域系统的滤波器。在计算控制器最终是否会达到稳定结果时，此性质很有用。如果数值挑选不当，控制系统的输入值会反复振荡，这导致系统可能永远无法达到预设值。

PID控制器的一般转移函数是：

$$
H(s) = \frac{K_d s^2 + K_p s + K_i}{s+C}
$$

其中$C$是一个取决于系统带宽的常数。

![PID控制器](./imgs/mechanism/PID.png)

PID控制器具有调节速度快、精度高、适应性强等优点，同时也存在参数调整困难、易受干扰等缺点。在实际应用中，需要根据不同的系统和应用需求，对PID控制器进行参数调整和优化，以获得最佳的控制效果。

## 调参技巧

PID控制器的控制效果和性能很大程度上取决于参数的调整。手动调整法是最简单和最基本的调参方法。该方法需要通过试错的方式，反复调整PID参数，观察输出响应、稳定性等指标，并根据调整结果不断优化参数，直到达到最佳控制效果。该方法虽然比较耗时，但对于简单的系统，效果较好。

具体步骤如下：

- 整定$K_p$
    - 设置积分系数$K_i=0$，微分系数$K_d=0$，由小到大改变比例系数$K_p$；
    - 让扰动信号作阶跃变化，直到获得满意的控制过程（反应快、超调小）；
- 整定$K_p$
    - 取比例系数$K_p=k * K_p, k \in [0.5, 0.8]$，由小到大增加积分系数$K_i$；
    - 让扰动信号作阶跃变化，直至求得满意的控制过程；
- 整定$K_p$：积分系数$K_i$保持不变，改变比例系数$K_p$，直到满意为止
- 重复以上试凑，直到找到满意的比例系数$K_p$和积分系数$K_i$为止；
- 整定$K_d$：和前述步骤相同，直到控制过程满意为止。

| 调整方式 | 数值上升时间 | 超调量 | 安定时间 | 稳态误差 | 稳定性 |
| ----- | ----- | ----- | ----- | ----- | ----- |
| $K_p \uparrow$ | 减少 | 增加 | 小幅增加 | 减少 | 变差 |
| $K_i \uparrow$ | 小幅减少 | 增加 | 增加 | 大幅减少 | 变差 |
| $K_d \uparrow$ | 小幅减少 | 减少 | 减少 | 变动不大 | 变好 |

## PID控制的局限性

- 线性：PID控制器常见的问题是在于其线性且对称的特性，若应用在一些非线性的系统，其效果可能会有变化。
- 易扰动：微分器对量测或程序产生的高频噪声会有放大效果，因此在存在大量噪声时，输出会受到大幅度的扰动。
